<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="author" content="order by dede58.com"/>
    <title>Mutual商城-个人中心</title>
    <link rel="stylesheet" type="text/css" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/bootstrap/css/bootstrap-fileinput.css">
    <script src="../static/js/js/jquery-3.2.1.js"></script>
    <script src="../static/bootstrap/js/bootstrap.min.js"></script>
    <script src="../static/bootstrap/js/bootstrap-fileinput.js"></script>
    <link href="../static/css/p.css" rel="stylesheet" type="text/css">


</head>

<style>
    .gzxx {font-size: 12px;font-weight: bold;color:rgb(117,117,117);width: 100px;display: inline-block}

</style>
<body>

<!-- start header -->
<header id="header">

</header>
<!--end header -->
<!-- start banner_x -->
<div class="banner_x center">
    <a href="./index.html" target="_blank"><div class="logo fl"></div></a>
    <a href=""><div class="ad_top fl"></div></a>
    <div class="nav fl">
        <ul>
            <li><a href="">商城首页 </a></li>

        </ul>
    </div>
    <div class="search fr">
        <form action="" method="post">
            <div class="text fl">
                <input type="text" class="shuru"  placeholder="输入关键字查询宝贝">
            </div>
            <div class="submit fl">
                <input type="submit" class="sousuo" value="搜索"/>
            </div>
            <div class="clear"></div>
        </form>
        <div class="clear"></div>
    </div>
</div>
<!-- end banner_x -->
<!-- self_info -->
<div class="grzxbj">
    <div class="selfinfo center">
        <div class="lfnav fl" style="height: 1300px">
            <div class="ddzx" style="height: 20px">个人中心</div>
            <div class="subddzx">
                <ul>
                    <li><a href="./self_info.html" >我的信息</a></li>
                    <li><a href="./self_info_edit.html">修改信息</a></li>
                    <li><a href="./self_info_pwd_edit.html">修改密码</a></li>
                    <li><a href="./coupon.html">优惠券</a></li>
                    <li><a href="./address.html">收货地址</a></li>
                    <li><a href="./point.html">我的积分</a></li>
                </ul>
            </div>
            <div class="ddzx" style="height: 20px">订单中心</div>
            <div class="subddzx">
                <ul>
                    <li><a href="./orders.html">我的订单</a></li>
                    <li><a href="./basket.html">我的购物车</a></li>
                    <li><a href="./favourite.html">我的收藏</a></li>
                    <li><a href="./footprint.html">我的足迹</a></li>
                </ul>
            </div>
        </div>
        <div class="rtcont fr"  style="width: 978px;height: 1300px;background: #fff">
            <div class="grzlbt ml40" id="address">修改收货地址</div>
            <!--新增地址-->

            <div data-spm="1998049142" class="m-logistics g-box-base g-mb-set" >
                <div class="s-bar" >
                    <i class="s-icon"></i>新增地址
                </div>
                <div class="s-content" style="height: 500px">
                    <ul class="lg-list">
                        <li class="lg-item">
                            <form>
                                <div hidden><input id="uid" hidden ></div>
                                <!--<div class=" gzxx ml40" style="width: 550px" >-->
                                    <!--<span class="gzxx" style="padding-right: 30px">国家：</span>-->
                                    <!--<input type="text" id="country" style="height: 30px;width: 260px" placeholder="country">-->
                                <!--</div>-->
                                <!--<br/><br/>-->
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px">省：</span>
                                    <input type="text" id="province" style="height: 30px;width: 260px" placeholder="province">
                                </div>
                                <br/><br/>
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px">市：</span>
                                    <input type="text" id="city" style="height: 30px;width: 260px" placeholder="city">
                                </div>
                                <br/><br/>
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px">区：</span>
                                    <input type="text" id="region" style="height: 30px;width: 260px" placeholder="region">
                                </div>
                                <br/><br/>
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px" >详细地址：</span>
                                    <textarea id="detail_address" style="resize: none" rows="3" cols="40" placeholder="请输入详细地址信息，如道路、门牌号、小区、楼栋号、单元等信息"></textarea>
                                </div>
                                <br/><br/>
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px">邮政编码：</span>
                                    <input type="text" id="post_code" style="height: 30px;width: 260px" placeholder="post_code">
                                </div>
                                <br/><br/>
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px">收货人姓名：</span>
                                    <input type="text" id="name" style="height: 30px;width: 260px" placeholder="name">
                                </div>
                                <br/><br/>
                                <div class=" gzxx ml40" style="width: 550px" >
                                    <span class="gzxx" style="padding-right: 30px">收货人手机号码：</span>
                                    <input type="text" id="phone_number" style="height: 30px;width: 260px" placeholder="phone_number">
                                </div>
                                <br/><br/>
                                <div lass=" gzxx ml40">
                                    <span style="padding-right: 40px"></span>
                                    <button href="self_info_edit.html" onclick="addAddress()">保存</button>
                                </div>

                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- self_info -->

<footer class="mt20 center">
    <!--<div class="mt20">小米商城|MIUI|米聊|多看书城|小米路由器|视频电话|小米天猫店|小米淘宝直营店|小米网盟|小米移动|隐私政策|Select Region</div>-->
    <div>©mi.com 京ICP证110507号 京ICP备10046444号 京公网安备11010802020134号 京网文[2014]0059-0009号</div>
    <div>违法和不良信息举报电话：185-0130-1238，本网站所列数据，除特殊说明，所有数据均出自我司实验室测试</div>
</footer>

<script>


    $(function () {
        $("#header").load("header.html");
    })

    // 获取地址id
    var id;
    function getId() {
        id=window.location.search.split("=")[1]
        alert(id)
    }
    getId();
    //根据id获取用户信息
    function getUserInfoById() {
        $.ajax({
            url:'/userInfoById_',
            type:'GET', //GET
            contentType:"application/json",
            dataType:'json',
            success:function(data){
                $("#uid").val(data.id);
            },
            error:function(data){
                console.error(data);
            }
        })
    }
    getUserInfoById();


    var pass=false;
    //失去焦点判断手机号是否符合规则
    $("#phone_number").blur(function () {
        var reg=/^1([38][0-9]|4[579]|5[0-3,5-9]|6[6]|7[0135678]|9[89])\d{8}$/
        var p=$("#phone_number").val()
        if (!reg.test(p)){
            alert("手机号输入不符合规则")
        }else {
            pass=true;
        }
    });


    // 提交表中信息

    function addAddress() {
        if ($("#province").val().trim() != '' &&
            $("#city").val().trim() != '' &&
            $("#region").val().trim() != '' &&
            $("#detail_address").val().trim() != '' &&
            $("#name").val().trim() != '' &&
            $("#phone_number").val().trim() != ''
        ) {
            $.ajax({
                url:'/updateOneAddress',
                type:'POST',
                contentType:"application/json",
                data:JSON.stringify({
                    province: $("#province").val(),
                    city:$("#city").val(),
                    region:$("#region").val(),
                    member_id:$("#uid").val(),
                    detail_address:$("#detail_address").val(),
                    post_code:$("#post_code").val(),
                    name:$("#name").val(),
                    phone_number:$("#phone_number").val(),
                    id:id,
                }),
                dataType:'json',   //返回的数据格式：json/xml/html/script/jsonp/text
                success:function(data){
                    alert(data)
                    console.log(data)
                    if (data) {
                        var url= "address.html"
                        window.location.href = url
                    }
                },
                error:function(data){
                    if (!data) {
                        var url= "address.html"
                        window.location.href = url                }}
            })
        }else {
            alert("地址输入不合法")
            return false;
        }
    }

//    显示编辑的地址信息

    function get() {
        alert(id)
        $.ajax({
            url:'/getOneAddress?addressId='+id,
            type:'GET', //GET
            contentType:"application/json",
            // data:JSON.stringify({addressId:id}),
            dataType:'json',
            success:function(data){
                console.log(data)
                $("#uid").val(data.member_id);
                $("#province").val(data.province);
                $("#city").val(data.city);
                $("#region").val(data.region);
                $("#detail_address").val(data.detail_address);
                $("#post_code").val(data.post_code);
                $("#name").val(data.name);
                $("#phone_number").val(data.phone_number);
            },
            error:function(data){
                console.log(data);
            }
        })
    }
    get();




</script>
</body>
</html>